<!DOCTYPE html>
<html>
   <head>
      <title>Retirement Income Calculator</title>
      <style>
         body {
            font-family: Arial, sans-serif;
            margin: 0 auto;
            padding: 20px;
            max-width: 600px;
            background-color: #f4f4f4;
            border-radius: 8px;
         }

         h1 {
            text-align: center;
            color: #333;
         }

         form {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
         }

         form div {
            margin-bottom: 15px;
         }

         label {
            display: block;
            margin-bottom: 5px;
            color: #555;
         }

         input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
         }

         button {
            background-color: #145bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
         }

         button:hover {
            background-color: #145bff;
         }

         #results {
            background-color: #e3e3e3;
            padding: 20px;
            border-radius: 8px;
         }

         #results h2 {
            margin-top: 0;
            color: #333;
         }

         #results p {
            margin-bottom: 10px;
            color: #555;
         }

         @media (max-width: 600px) {
            form {
               padding: 10px;
            }
            body {
               padding: 10px;
            }
         }
      </style>
   </head>
   <body>
      <h1>Retirement Income Calculator</h1>
      <form id="retirementForm">
         <div>
            <label for="currentAge">Current Age:</label>
            <input type="number" id="currentAge" name="currentAge" required />
         </div>
         <div>
            <label for="retirementAge">Retirement Age:</label>
            <input type="number" id="retirementAge" name="retirementAge" required />
         </div>
         <div>
            <label for="annualIncome">Annual Income ($):</label>
            <input type="number" id="annualIncome" name="annualIncome" required />
         </div>
         <div>
            <label for="annualSavings">Annual Savings ($):</label>
            <input type="number" id="annualSavings" name="annualSavings" oninput="calculateSavingsRate()" />
         </div>
         <div>
            <label for="savingsRate">Annual Savings (% of Income):</label>
            <input type="number" id="savingsRate" name="savingsRate" min="0" max="100" readonly />
         </div>
         <div>
            <label for="currentSavings">Current Retirement Savings ($):</label>
            <input type="number" id="currentSavings" name="currentSavings" required />
         </div>
         <div>
            <label for="retirementIncomeRate">Current Income Needed in Retirement (%):</label>
            <input type="number" id="retirementIncomeRate" name="retirementIncomeRate" min="0" max="100" value="75" required />
         </div>
         <div>
            <label for="annualReturn">Expected Annual Return (%):</label>
            <input type="number" id="annualReturn" name="annualReturn" step="0.01" value="6" required />
         </div>
         <button type="button" onclick="calculateRetirement()">Calculate</button>
      </form>

      <div id="results">
         <h2>Results</h2>
         <p>Retirement Age: <span id="retirementAgeResult"></span></p>
         <p>Estimated Retirement Savings Balance: <span id="retirementBalanceResult"></span></p>
         <p>Estimated Monthly Expenses in Retirement: <span id="monthlyExpensesResult"></span></p>
         <p>Estimated Monthly Income in Retirement: <span id="monthlyIncomeResult"></span></p>
      </div>

      <script>
         function calculateSavingsRate() {
            const annualIncome = parseFloat(document.getElementById("annualIncome").value);
            const annualSavings = parseFloat(document.getElementById("annualSavings").value);

            if (!isNaN(annualIncome) && !isNaN(annualSavings) && annualIncome > 0) {
               const savingsRate = (annualSavings / annualIncome) * 100;
               document.getElementById("savingsRate").value = savingsRate.toFixed(1); // Changed to 1 decimal place
            } else {
               document.getElementById("savingsRate").value = ""; // Clear the field if inputs are invalid
            }
         }

         function calculateRetirement() {
            const currentAge = parseInt(document.getElementById("currentAge").value);
            const retirementAge = parseInt(document.getElementById("retirementAge").value);
            const annualIncome = parseFloat(document.getElementById("annualIncome").value);
            const annualSavings = parseFloat(document.getElementById("annualSavings").value || 0); // Handle potential empty input
            const savingsRate = parseFloat(document.getElementById("savingsRate").value || 0) / 100; // Handle percentage
            const currentSavings = parseFloat(document.getElementById("currentSavings").value);
            const retirementIncomeRate = parseFloat(document.getElementById("retirementIncomeRate").value) / 100;
            const annualReturn = parseFloat(document.getElementById("annualReturn").value) / 100;

            const yearsOfSaving = retirementAge - currentAge;
            let actualAnnualSavings = annualSavings;
            if (savingsRate > 0) {
               actualAnnualSavings = annualIncome * savingsRate;
            }

            // Future Value Calculation - MATCHING GOOGLE SHEET FORMULA
            const presentValue = currentSavings;
            const monthlyInterestRate = annualReturn / 12;
            const totalNumberOfMonths = yearsOfSaving * 12;
            const futureValue = presentValue * Math.pow(1 + monthlyInterestRate, totalNumberOfMonths);

            // Monthly Expenses Calculation - MATCHING GOOGLE SHEET FORMULA
            const estimatedMonthlyExpenses = (retirementIncomeRate * annualIncome) / 12;

            // Monthly Income Calculation - MATCHING GOOGLE SHEET FORMULA
            const estimatedMonthlyIncome = (futureValue * 0.04) / 12;

            document.getElementById("retirementAgeResult").textContent = retirementAge;
            document.getElementById("retirementBalanceResult").textContent = `$${futureValue.toFixed(2)}`;
            document.getElementById("monthlyExpensesResult").textContent = `$${estimatedMonthlyExpenses.toFixed(2)}`;
            document.getElementById("monthlyIncomeResult").textContent = `$${estimatedMonthlyIncome.toFixed(2)}`;
         }
      </script>
   </body>
</html>
